#! /usr/bin/env node

var fs = require('fs')
var assert = require('assert')
var _ = require('underscore')
var modules = require('../repos.json')
  .map(function(m){
    return {
      name: m,
      dirname: m.replace('/', '-').toLowerCase()
    }
  })

console.log('# of repos', modules.length)

var modEntries = modules.map(function(m){ return m.dirname })

var entries = fs.readdirSync('repos')
  .map(function(e){
    return e.toLowerCase()
  })

console.log('# of cloned reps', entries.length)

var remaining = []
modules.forEach(function(module){
  if (entries.indexOf(module.dirname) === -1){
    remaining.push(module.name)
  }
})

console.log('# of remaining packages:', remaining.length)

assert(remaining.length === modules.length - entries.length)

var output = JSON.stringify(remaining, null, '  ')
fs.writeFileSync('remaining.json', output)

console.log('Wrote to remaining.json')

function findDups(arr){
  var sorted_arr = arr.sort();
  var results = [];
  for (var i = 0; i < arr.length - 1; i++) {
      if (sorted_arr[i + 1] == sorted_arr[i]) {
          results.push(sorted_arr[i]);
      }
  }
  return results;
}